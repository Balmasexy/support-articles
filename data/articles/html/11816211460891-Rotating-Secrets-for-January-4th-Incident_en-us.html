<h1 id="01GP1JQZVHEA8VCA9FP9A3C8B6">Steps for Secret Rotation (Updated Jan 6th)</h1>
<p><span>Based on the January 4th security notice, we recommend taking the following steps to rotate your tokens: </span></p>
<p><span style="font-weight: 400;">There are multiple ways to do this, and we encourage you and your teams to use your preferred methods. Here is an approach you may choose to follow:<br></span></p>
<p> </p>
<p><strong>Note: It is recommended that you log out of CircleCI prior to revoking access to GitHub</strong></p>
<ol>
    <li style="font-weight: 400;" aria-level="1">
        <strong>OAuth tokens</strong><span style="font-weight: 400;">:</span>
        <ol>
            <li style="font-weight: 400;" aria-level="2">
                <span style="font-weight: 400;">For GitHub: We are rotating all GitHub OAuth tokens on behalf of customers and will update when this process is complete. Customers who wish to do so may rotate their own OAuth tokens by logging out of the CircleCI application, going to </span><a href="https://github.com/settings/applications"><span style="font-weight: 400;">https://github.com/settings/applications</span></a><span style="font-weight: 400;">, selecting "Authorized OAuth Apps", and then revoking the CircleCI entry. Once that's done, log back into CircleCI to trigger reauthorization.</span>
            </li>
            <li style="font-weight: 400;" aria-level="2"><span style="font-weight: 400;">For Bitbucket: As of 10:00 UTC on January 6, 2023 our partners at Atlassian expired all OAuth tokens for Bitbucket users. Bitbucket tokens will refresh for users upon login, and no additional action is needed here. Bitbucket users will still need to replace SSH tokens.  </span></li>
            <li style="font-weight: 400;" aria-level="2"><span style="font-weight: 400;">For GitLab: GitLab users do not need to reauthorize their application access. As a precautionary measure, we would still recommend GitLab users rotate their environment variables, Personal and Project API tokens, and all SSH keys.</span></li>
        </ol>
    </li>
    <li style="font-weight: 400;" aria-level="1">
        <strong>Project API tokens</strong><span style="font-weight: 400;">: To rotate them, go to Project Settings &gt; API Permissions &gt; Add API Token. </span><strong>Update: CircleCI has revoked all tokens created before 00:00 UTC on January 5, 2023. </strong>
    </li>
    <li style="font-weight: 400;" aria-level="1">
        <strong>Project environment variables</strong><span style="font-weight: 400;">: Go to Project Settings &gt; Environment Variables and then create an environment variable with the same name to replace the existing value.</span>
    </li>
    <li style="font-weight: 400;" aria-level="1">
        <strong>Context variables</strong><span style="font-weight: 400;">: Go to Organization Settings &gt; Contexts and do the same thing as for project environment variables for each context.</span>
    </li>
    <li style="font-weight: 400;" aria-level="1">
        <strong>User API tokens</strong><span style="font-weight: 400;">: Go to User Settings &gt; Personal API Tokens and then delete and recreate any tokens you might be using. </span><strong>Update: CircleCI has revoked all tokens created before 00:00 UTC on January 5, 2023.</strong>
    </li>
    <li style="font-weight: 400;" aria-level="1">
        <strong>Project SSH keys</strong><span style="font-weight: 400;">: </span>
        <ol>
            <li style="font-weight: 400;" aria-level="2"><span style="font-weight: 400;">Go to Project Settings &gt; SSH Keys. </span></li>
            <li style="font-weight: 400;" aria-level="2"><span style="font-weight: 400;">Delete the Deploy Key and add it again. </span></li>
            <li style="font-weight: 400;" aria-level="2"><span style="font-weight: 400;">If you were using any additional keys, then those need to be deleted and recreated. </span></li>
            <li style="font-weight: 400;" aria-level="2">
                <span style="font-weight: 400;">Note: We recommend this for all projects ("go to Project Settings"), orgs (”go to Organization Settings"), and users ("go to User Settings").</span><span style="font-weight: 400;"></span>
            </li>
        </ol>
    </li>
    <li style="font-weight: 400;" aria-level="1">
        <strong>Runner Tokens</strong><span style="font-weight: 400;">: using the CircleCI CLI, run the following commands:</span><br>
        <ol>
            <li style="font-weight: 400;" aria-level="2">
                <pre><span style="font-weight: 400;">circleci runner token list &lt;resource-class name&gt; </span></pre>
            </li>
            <li style="font-weight: 400;" aria-level="2">
                <pre><span style="font-weight: 400;">circleci runner token delete "&lt;token identifier&gt;"</span></pre>
            </li>
            <li style="font-weight: 400;" aria-level="2">
                <pre><span style="font-weight: 400;">circleci runner token create &lt;resource-class-name&gt; "&lt;nickname&gt;"</span></pre>
            </li>
            <li style="font-weight: 400;" aria-level="2"><span style="font-weight: 400;">Following these commands, you will need to add the created token to your launch-agent-config.yml and restart your runner service</span></li>
        </ol>
    </li>
</ol>
<p><span><span style="font-weight: 400;">Note: there is also a </span><a href="https://github.com/CircleCI-Public/CircleCI-Env-Inspector"><span style="font-weight: 400;">tool for discovering all your secrets on CircleCI</span></a><span style="font-weight: 400;"> that can be used to find an actionable list of items for rotation.</span></span></p>
<p><span>For more information, please visit <a href="https://circleci.com/blog/january-4-2023-security-alert/">https://circleci.com/blog/january-4-2023-security-alert/</a></span></p>